"0","# Best subset"
"0","regfit.full <- regsubsets(y ~ ., data = train.dat, nvmax = 1000)"
"0","regsum <- summary(regfit.full)"
"0",""
"0","x.out <- model.matrix(y ~ ., data = train.dat)"
"0","y.hat <- matrix(nrow = 20, ncol = 100)"
"0","mses <- numeric(20)"
"0",""
"0","for(i in 1:20){"
"0","  # grab coef estimates for each model size"
"0","  coefs <- coef(regfit.full, i) "
"0","  vars <- names(coefs)"
"0","  # predict for the model with i input variables"
"0","  y.hat[i,] <- t(coefs) %*% t(x.out[,vars]) "
"0","  mses[i] <- mean((y[train.ind] - y.hat[i,])^2) # save mean squared residuals"
"0","}"
"0",""
"0","plot(mses, type=""l"", xlab=""Number of Predictors"", ylab=""MSE"")"
